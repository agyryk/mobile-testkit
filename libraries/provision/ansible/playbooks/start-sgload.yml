---
- hosts: load_generators
  any_errors_fatal: true

  # Kill gateload
  tasks:
  - name: kill previous sgload screen
    shell: screen -X -S sgload kill
    ignore_errors: yes
  - name: kill previous sgload_expvars screen
    shell: screen -X -S sgload_expvars kill
    ignore_errors: yes


- hosts: load_generators
  any_errors_fatal: true

  # Deploy sgload script and start it
  tasks:
  - name: copy the run sgload script
    copy: src=files/run_sgload.sh dest=/home/centos/ owner=centos group=centos mode=0755
  - name: start sgload in screen
    shell: screen -d -m -S sgload ./run_sgload.sh
    args:
      chdir: /home/centos/



